% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/consensus_seed.R
\name{desurv_consensus_seed}
\alias{desurv_consensus_seed}
\title{Build a consensus initialization from multiple DeSurv fits}
\usage{
desurv_consensus_seed(
  fits,
  X,
  ntop,
  k = NULL,
  clustering = c("average", "complete", "single")
)
}
\arguments{
\item{fits}{A list of \code{desurv_fit} objects (or a single fit) obtained
from running \code{desurv_fit()} with different random seeds.}

\item{X}{Numeric matrix containing the training data used for each fit
(genes in rows, samples in columns). Row order should match the
\code{W} matrices stored in \code{fits}. If rownames are available they
will be used to align \code{X} to the consensus initialization.}

\item{ntop}{Positive integer specifying how many top genes per factor are
considered when computing the co-occurrence matrix.}

\item{k}{Optional integer overriding the rank taken from the supplied fits.
Defaults to the number of columns in the first fit's \code{W}.}

\item{clustering}{Character string passed to \code{\link[stats]{hclust}}
to control the agglomerative linkage (default \code{"average"}).}
}
\value{
A list containing:
\itemize{
\item \code{W0}: consensus basis matrix (genes x factors).
\item \code{H0}: non-negative coefficients computed via NNLS so that
\code{W0 \%*\% H0} approximates \code{X}.
\item \code{beta0}: zero vector of length \code{k} (for convenience when
seeding \code{desurv_fit()}).
\item \code{consensus}: normalised gene co-occurrence matrix.
\item \code{counts}: raw co-occurrence counts.
\item \code{frequency}: per-gene selection counts (diagonal of
\code{counts}).
\item \code{clusters}: integer cluster labels used to build \code{W0}.
\item \code{ntop}: number of top genes used per factor.
\item \code{n_factors}: total number of short-run factors contributing to
the consensus.
}
}
\description{
Aggregate the top genes that appear in each latent factor across several
independently initialized \code{desurv_fit} objects, compute a consensus
co-occurrence matrix, and derive a deterministic \eqn{W_0} (and matching
\eqn{H_0}) that can be supplied to \code{\link{desurv_fit}} for a final,
fully optimized run. The consensus weights are obtained by clustering the
co-occurrence matrix, normalising the resulting cluster profiles, and
solving non-negative least squares problems to align \eqn{H_0} with the
observed data matrix \code{X}.
}
